
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Database Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="files.html" />
    
    
    <link rel="prev" href="configuration.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../getting-started.html">
            
                <a href="../getting-started.html">
            
                    
                    Getting Started
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Servers
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../servers/undertow.html">
            
                <a href="../servers/undertow.html">
            
                    
                    Undertow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../servers/servlet3.html">
            
                <a href="../servers/servlet3.html">
            
                    
                    Servlet 3
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Features
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="configuration.html">
            
                <a href="configuration.html">
            
                    
                    Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.2" data-path="database.html">
            
                <a href="database.html">
            
                    
                    Database
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="files.html">
            
                <a href="files.html">
            
                    
                    Files
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="identity.html">
            
                <a href="identity.html">
            
                    
                    Identity
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="listeners.html">
            
                <a href="listeners.html">
            
                    
                    Listeners
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="message-actions.html">
            
                <a href="message-actions.html">
            
                    
                    Message Actions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="social.html">
            
                <a href="social.html">
            
                    
                    Social
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="types.html">
            
                <a href="types.html">
            
                    
                    Types
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Database</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="database">Database</h1>
<p>A <strong>Database</strong> is a way for Services to handle Database actions in a managed way, using previously-defined <a href="types.html">Types</a>.</p>
<p>The Java SDK provides a way to easily create Databases in your Service. The following documentation should give you a nice overview of how to define and use them.</p>
<h2 id="interfaces">Interfaces</h2>
<p>There are 2 interfaces to choose from when defining a Database, depending on how your Types are defined.</p>
<h3 id="databasec-extends-configuration-t-extends-type">Database&lt;C extends Configuration, T extends Type&gt;</h3>
<p>This interface should be used if your Service contains statically-defined Types (using the <code>Type</code> interface).</p>
<h4 id="generic-type-parameters">Generic Type Parameters</h4>
<ul>
<li><code>C</code> - this parameter must be the previously-defined <a href="configuration.html">Configuration Settings</a> class</li>
<li><code>T</code> - this parameter must be the previously-defined <a href="types.html">Type</a></li>
</ul>
<h4 id="methods">Methods</h4>
<p>All methods have <code>C configuration</code> as their first parameter, which is an instance of the Service&apos;s <a href="configuration.html">Configuration Settings</a> class, populated with the appropriate values from the request.</p>
<ul>
<li><code>T create(C configuration, T object)</code>:<ul>
<li><code>object</code> - the object to be created/saved by the Service</li>
</ul>
</li>
</ul>
<p>This method will take the object passed in, assign an ID to it, save it in the appropriate store then return the object again (with the created ID).</p>
<ul>
<li><code>List&lt;T&gt; create(C configuration, List&lt;T&gt; objects)</code>:<ul>
<li><code>objects</code> - a list of objects to be created/saved by the Service</li>
</ul>
</li>
</ul>
<p>This method will take a list of objects passed in, assign IDs to each item, save them in the appropriate store then return the list of objects again (with the created IDs).</p>
<ul>
<li><code>void delete(C configuration, T object)</code>:<ul>
<li><code>object</code> - the object to be deleted by the Service</li>
</ul>
</li>
</ul>
<p>This method will take the passed in object and delete it from the appropriate store.</p>
<ul>
<li><code>void delete(C configuration, List&lt;T&gt; objects)</code>:<ul>
<li><code>objects</code> - the list of objects to be deleted by the Service</li>
</ul>
</li>
</ul>
<p>This method will take the passed in objects and delete them from the appropriate store.</p>
<ul>
<li><code>T update(C configuration, T object)</code>:<ul>
<li><code>object</code> - the object to be updated/saved by the Service</li>
</ul>
</li>
</ul>
<p>This method will take the object passed in, update the existing record in the appropriate store, then return the updated object again.</p>
<ul>
<li><code>List&lt;T&gt; update(C configuration, List&lt;T&gt; objects)</code>:<ul>
<li><code>objects</code> - the list of objects to be updated/saved by the Service</li>
</ul>
</li>
</ul>
<p>This method will take the list of objects passed in, update the existing records in the appropriate store, then return the updated list of objects again.</p>
<h3 id="rawdatabasec-extends-configuration">RawDatabase&lt;C extends Configuration&gt;</h3>
<p>This interface should be used if your Service contains dynamically-defined Types (probably through the <code>TypeProvider</code> interface).</p>
<h4 id="generic-type-parameters">Generic Type Parameters</h4>
<ul>
<li><code>C</code> - this parameter must be the previously-defined <a href="configuration.html">Configuration Settings</a> class</li>
</ul>
<h4 id="methods">Methods</h4>
<p>All methods have <code>C configuration</code> as their first parameter, which is an instance of the Service&apos;s <a href="configuration.html">Configuration Settings</a> class, populated with the appropriate values from the request.</p>
<ul>
<li><code>MObject create(C configuration, MObject object)</code>:<ul>
<li><code>object</code> - the object to be created/saved by the Service</li>
</ul>
</li>
</ul>
<p>This method will take the object passed in, assign an External ID to it, extract the Properties, save them in the appropriate store then return the object again (with the created External ID).</p>
<ul>
<li><code>List&lt;MObject&gt; create(C configuration, List&lt;MObject&gt; objects)</code>:<ul>
<li><code>objects</code> - a list of objects to be created/saved by the Service</li>
</ul>
</li>
</ul>
<p>This method will take a list of objects passed in, assign External IDs to each item, extract the Properties, save them in the appropriate store then return the list of objects again (with the created External IDs).</p>
<ul>
<li><code>void delete(C configuration, MObject object)</code>:<ul>
<li><code>object</code> - the object to be deleted by the Service</li>
</ul>
</li>
</ul>
<p>This method will take the passed in object and delete it from the appropriate store.</p>
<ul>
<li><code>void delete(C configuration, List&lt;MObject&gt; objects)</code>:<ul>
<li><code>objects</code> - the list of objects to be deleted by the Service</li>
</ul>
</li>
</ul>
<p>This method will take the passed in objects and delete them from the appropriate store.</p>
<ul>
<li><code>MObject update(C configuration, MObject object)</code>:<ul>
<li><code>object</code> - the object to be updated/saved by the Service</li>
</ul>
</li>
</ul>
<p>This method will take the object passed in, update the existing record in the appropriate store, then return the updated object again.</p>
<ul>
<li><code>List&lt;MObject&gt; update(C configuration, List&lt;MObject&gt; objects)</code>:<ul>
<li><code>objects</code> - the list of objects to be updated/saved by the Service</li>
</ul>
</li>
</ul>
<p>This method will take the list of objects passed in, update the existing records in the appropriate store, then return the updated list of objects again.</p>
<h2 id="example">Example</h2>
<p>This example shows a Database implementation to handle a Type called <code>Person</code>:</p>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> com.manywho.sdk.api.run.elements.type.ListFilter;
<span class="hljs-keyword">import</span> com.manywho.sdk.services.database.Database;
<span class="hljs-keyword">import</span> com.manywho.services.example.ServiceConfiguration;
<span class="hljs-keyword">import</span> com.manywho.services.example.repositories.PersonRepository;
<span class="hljs-keyword">import</span> com.manywho.services.example.types.Person;

<span class="hljs-keyword">import</span> javax.inject.Inject;
<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.stream.Collectors;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PersonDatabase</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Database</span>&lt;<span class="hljs-title">ServiceConfiguration</span>, <span class="hljs-title">Person</span>&gt; </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> PersonRepository personRepository;

    <span class="hljs-meta">@Inject</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">PersonDatabase</span><span class="hljs-params">(PersonRepository personRepository)</span> </span>{
        <span class="hljs-keyword">this</span>.personRepository = personRepository;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Person <span class="hljs-title">create</span><span class="hljs-params">(ServiceConfiguration configuration, Person person)</span> </span>{
        <span class="hljs-keyword">return</span> personRepository.create(configuration, person);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Person&gt; <span class="hljs-title">create</span><span class="hljs-params">(ServiceConfiguration configuration, List&lt;Person&gt; objects)</span> </span>{
        <span class="hljs-keyword">return</span> objects.stream()
                      .map(object -&gt; create(configuration, object))
                      .collect(Collectors.toList());
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">delete</span><span class="hljs-params">(ServiceConfiguration configuration, Person person)</span> </span>{
        personRepository.delete(configuration, person);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">delete</span><span class="hljs-params">(ServiceConfiguration configuration, List&lt;Person&gt; objects)</span> </span>{
        objects.forEach(object -&gt; delete(configuration, object));
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Person <span class="hljs-title">find</span><span class="hljs-params">(ServiceConfiguration configuration, String id)</span> </span>{
        <span class="hljs-keyword">return</span> personRepository.find(id);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Person&gt; <span class="hljs-title">findAll</span><span class="hljs-params">(ServiceConfiguration configuration, ListFilter filter)</span> </span>{
        <span class="hljs-keyword">return</span> personRepository.findAll(filter.getLimit(), filter.getOffset());
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Person <span class="hljs-title">update</span><span class="hljs-params">(ServiceConfiguration configuration, Person person)</span> </span>{
        <span class="hljs-keyword">return</span> personRepository.update(configuration, person);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Person&gt; <span class="hljs-title">update</span><span class="hljs-params">(ServiceConfiguration configuration, List&lt;Person&gt; people)</span> </span>{
        <span class="hljs-keyword">return</span> people.stream()
                     .map(person -&gt; update(configuration, person))
                     .collect(Collectors.toList());
    }
}
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="configuration.html" class="navigation navigation-prev " aria-label="Previous page: Configuration">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="files.html" class="navigation navigation-next " aria-label="Next page: Files">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Database","level":"1.4.2","depth":2,"next":{"title":"Files","level":"1.4.3","depth":2,"path":"docs/features/files.md","ref":"docs/features/files.md","articles":[]},"previous":{"title":"Configuration","level":"1.4.1","depth":2,"path":"docs/features/configuration.md","ref":"docs/features/configuration.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"docs/features/database.md","mtime":"2017-03-17T15:41:53.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-09-23T18:14:57.899Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

